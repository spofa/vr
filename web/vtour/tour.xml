<krpano version="1.19" title="test">



	<include url="%SWFPATH%/skin/vtourskin.xml" />

	<!-- 自动旋转 -->
	<autorotate enabled="true"
				waittime="3.0"
				speed="3.0"
				horizon="0.0"
				tofov="120.0"
	/>


	<!--
        For an alternative skin design either change the <skin_settings> values
        from above or optionally include one of the predefined designs from below.
    -->
	<!-- <include url="skin/vtourskin_design_flat_light.xml"  /> -->
	<!-- <include url="skin/vtourskin_design_glass.xml"       /> -->
	<!-- <include url="skin/vtourskin_design_ultra_light.xml" /> -->
	<!-- <include url="skin/vtourskin_design_117.xml"         /> -->
	<!-- <include url="skin/vtourskin_design_117round.xml"    /> -->
	<!-- <include url="skin/vtourskin_design_black.xml"       /> -->

	<!-- startup action - load the first scene -->
	<action name="startup" autorun="onstart">
		if(startscene === null OR !scene[get(startscene)], copy(startscene,scene[0].name); );
		loadscene(get(startscene), null, MERGE);
		if(startactions !== null, startactions() );
	</action>





	<skin_settings littleplanetintro="true" />

	<plugin devices="flash" name="ui1" url="%SWFPATH%/plugins/videoplayer.swf" alturl="%SWFPATH%/plugins/videoplayer.js" updateeveryframe="true" videourl="%SWFPATH%/video/13788051596B1D.flv" loop="true" volume="0.7" onhover="showtext('点击播放/暂停');" onclick="togglepause();" zorder="100" alpha="1" align="rightbottom" x="-30" y="80" ox="0" oy="0" width="" height="" scale="1" visible="true" enabled="true" capture="true" keep="true" showpic=""/>

	<!-- 拖动热点动态获取坐标 - call it once in the ondown event -->
	<action name="draghotspot">
		spheretoscreen(ath, atv, hotspotcenterx, hotspotcentery, 'l');
		sub(drag_adjustx, mouse.stagex, hotspotcenterx);
		sub(drag_adjusty, mouse.stagey, hotspotcentery);
		asyncloop(pressed,
		sub(dx, mouse.stagex, drag_adjustx);
		sub(dy, mouse.stagey, drag_adjusty);
		screentosphere(dx, dy, ath, atv);
		<!-- 将坐标赋值到当前热点 -->
		set(hlookat,get(ath));
		set(vlookat,get(atv));
		<!--jscall(calc('console.log("ath:'+ath+',atv:'+atv+'")'));-->
		);
	</action>

<!--    <{foreach $pro.scenes as $k=>$v}>-->
    <?php foreach($xml as $k=>$v):?>
    <scene name="<?= $k;?>" title="<?=$v['view']['title']?>">

<!--     <{if $pro.radars neq "" }> onstart="activatespot(<{$pro.radars[$k].rotate}>)" <{/if}>-->
<!--     thumburl="<{$v.img}>thumb.jpg" lat="" lng="" heading="">-->

<!--    <{if $pro.bd && $pro.logo}>-->
   <!-- the floor platform -->
<!--    <hotspot zorder="1" distorted="true" enabled="false"-->
<!--             url="<{$_lang.img_host}><{$pro.uid}>/logo.png" width="250" height="250" alpha="1"-->
<!--             rx="-90" ty="5000" scale="5"-->
<!--            />-->
<!--    <{/if}>-->

    <view hlookat="<?php echo ($v['view']['hlookat'])?$v['view']['hlookat']:0;  ?>" vlookat="<?php echo ($v['view']['vlookat'])?$v['view']['vlookat']:0;  ?>"
    fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto" />

<!--    <preview url="<{$v.img}>preview.jpg" />-->
<!--    <image>-->
<!--        <cube url="<{$v.img}>pano_%s.jpg" />-->
<!--        <cube url="<{$v.img}>mobile/pano_%s.jpg" devices="mobile" />-->
<!--    </image>-->

    <preview url="panos/baidu.tiles/preview.jpg" />

    <image type="CUBE" multires="true" tilesize="512" if="!webvr.isenabled">
        <level tiledimagewidth="128" tiledimageheight="128">
            <cube url="panos/baidu.tiles/%s/l1/%v/l1_%s_%v_%h.jpg" />
        </level>
    </image>

    <image if="webvr.isenabled">
        <cube url="panos/baidu.tiles/vr/pano_%s.jpg" />
    </image>

    <?php if($v['hotspots'] && is_array($v['hotspots']) && count($v['hotspots'])):    ?>
    <?php foreach($v['hotspots'] as $k2 => $v2): ?>
    <hotspot name="<?= $v2['hname'];>" style="skin_hotspotstyle" distorted="true" depth="10000" scale="6" zoom="false" ath="<?= $v2['ath'];>" atv="<?=$v2['hname'];?>" rotate="<?=intval($v2['rotate']);?>" linkedscene="<?=$v2['linkedscene'];?>" />
    <?php endforeach; ?>
    <?php endif; ?>


<!--    <{foreach $v.picspots as $v3}>-->
<!--    <hotspot name="<{$v3.hname}>" url="<{$v3.url}>" distorted="true" depth="<{$v3.depth}>" scale="<{$v3.scale}>" ath="<{$v3.ath}>" atv="<{$v3.atv}>" rotate="<{intval($v3.rotate)}>"/>-->
<!--    <{/foreach}>-->

    </scene>
    <?php endforeach;?>
</krpano>